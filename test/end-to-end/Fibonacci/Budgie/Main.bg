file start : Fibonacci Main
    import local : Fibonacci Generation CachingGenerator use CachingGenerator
    import local : Fibonacci Generation IGenerator types IGenerator
    import local : Fibonacci Generation NonCachingGenerator use NonCachingGenerator

    main context start
        standalone function declare start : private GetLabel string index int
            if start : { operation : { variable : index } (equal to) 1 }
                return : "st"
            else if start : { operation : { variable : index } (equal to) 2 }
                return : "nd"
            else if start : { operation : { variable : index } (equal to) 3 }
                return : "rd"
            if end

            return : "th"
        standalone function declare end

        standalone function declare start : private UseGenerator void generator IGenerator
            for numbers start : i int 0 10
                variable declare : label string { standalone function : private { main group } GetLabel { variable : i } }
                print : { string format : ("The {0}{1} Fibonacci number is {2}") { variable : i } int { variable : label } string { member function : public { variable : generator } Generate { variable : i } } int }
            for numbers end
        standalone function declare end

        standalone function declare start : private CheckCache void generator CachingGenerator index int
            if start : { member function : public { variable : generator } IsCached { variable : index } }
                print : { string format : ("{0} is cached.") { variable : index } int }
            else start
                print : { string format : ("{0} is not cached.") { variable : index } int }
            if end
        standalone function declare end

        main start
            variable declare : cached CachingGenerator { new : CachingGenerator }
            variable declare : uncached IGenerator { new : NonCachingGenerator }

            standalone function : private { main group } UseGenerator { variable : cached }
            standalone function : private { main group } UseGenerator { variable : uncached }

            standalone function : private { main group } CheckCache { variable : cached } 7
            standalone function : private { main group } CheckCache { variable : cached } 14
        main end
    main context end
file end
